{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://observability-hub.com/schemas/log-event.schema.json",
  "title": "Log Event Schema",
  "description": "Schema for log message events in the observability system",
  "allOf": [
    {
      "$ref": "base-event.schema.json"
    },
    {
      "type": "object",
      "properties": {
        "eventType": {
          "type": "string",
          "pattern": "^log\\.(message|error|warning|info|debug)\\.(created|updated)$"
        },
        "data": {
          "type": "object",
          "required": ["level", "message", "timestamp"],
          "properties": {
            "level": {
              "type": "string",
              "enum": ["TRACE", "DEBUG", "INFO", "WARN", "ERROR", "FATAL"],
              "description": "Log level severity"
            },
            "message": {
              "type": "string",
              "minLength": 1,
              "maxLength": 32768,
              "description": "The actual log message"
            },
            "timestamp": {
              "type": "string",
              "format": "date-time",
              "description": "When the original log was generated"
            },
            "logger": {
              "type": "object",
              "required": ["name"],
              "properties": {
                "name": {
                  "type": "string",
                  "minLength": 1,
                  "description": "Logger name or category"
                },
                "version": {
                  "type": "string",
                  "description": "Logging library version"
                },
                "thread": {
                  "type": "string",
                  "description": "Thread or process name/ID"
                }
              },
              "additionalProperties": false
            },
            "context": {
              "type": "object",
              "properties": {
                "userId": {
                  "type": "string",
                  "format": "uuid",
                  "description": "User ID associated with this log"
                },
                "sessionId": {
                  "type": "string",
                  "description": "Session identifier"
                },
                "requestId": {
                  "type": "string",
                  "format": "uuid",
                  "description": "Request ID"
                },
                "operation": {
                  "type": "string",
                  "description": "Operation or method name"
                },
                "component": {
                  "type": "string",
                  "description": "Component or module name"
                }
              },
              "additionalProperties": true
            },
            "structured": {
              "type": "object",
              "description": "Structured log data with typed fields",
              "properties": {
                "fields": {
                  "type": "object",
                  "additionalProperties": true,
                  "description": "Dynamic structured fields"
                },
                "metrics": {
                  "type": "object",
                  "properties": {
                    "duration": {
                      "type": "number",
                      "minimum": 0,
                      "description": "Operation duration in milliseconds"
                    },
                    "memoryUsage": {
                      "type": "integer",
                      "minimum": 0,
                      "description": "Memory usage in bytes"
                    },
                    "cpuUsage": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 100,
                      "description": "CPU usage percentage"
                    }
                  },
                  "additionalProperties": true
                }
              },
              "additionalProperties": false
            },
            "error": {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "description": "Error type or class name"
                },
                "code": {
                  "type": "string",
                  "description": "Error code or identifier"
                },
                "stack": {
                  "type": "string",
                  "description": "Stack trace"
                },
                "cause": {
                  "type": "string",
                  "description": "Root cause description"
                },
                "fingerprint": {
                  "type": "string",
                  "description": "Error fingerprint for deduplication"
                }
              },
              "additionalProperties": false
            },
            "source": {
              "type": "object",
              "properties": {
                "file": {
                  "type": "string",
                  "description": "Source file name"
                },
                "line": {
                  "type": "integer",
                  "minimum": 1,
                  "description": "Line number in source file"
                },
                "function": {
                  "type": "string",
                  "description": "Function or method name"
                },
                "class": {
                  "type": "string",
                  "description": "Class name"
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        }
      }
    }
  ]
} 